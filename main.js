(()=>{"use strict";const e=function(){return{board:function(){let e=function(){let e=new Map;for(let t=0;t<10;t++)for(let n=0;n<10;n++)e.set(JSON.stringify([t,n]),{attacked:!1,occupied:!1,ship:null});return e}(),t=new Map;return{coordinates:e,placeShip:function(n,o,i,s){let c=JSON.parse(o),r=JSON.parse(o),a=JSON.parse(o),l=function(e){return{hit:function(){this.hits++},isSunk:function(){return this.hits==this.length},length:e,hits:0}}(n);if(a[1]=l.length-1+c[1],a[0]=l.length-1+c[0],i&&a[1]<10){t.set(s,l),e.get(JSON.stringify(r)).occupied=!0,e.get(JSON.stringify(r)).name=s;for(let t=1;t<n;t++)r[1]++,e.get(JSON.stringify(r)).occupied=!0,e.get(JSON.stringify(r)).name=s}else if(!i&&a[0]<10){t.set(s,l),e.get(JSON.stringify(r)).occupied=!0,e.get(JSON.stringify(r)).name=s;for(let t=1;t<n;t++)r[0]++,e.get(JSON.stringify(r)).occupied=!0,e.get(JSON.stringify(r)).name=s}},shipCount:function(){return t.size},ships:t,receiveAttack:function(n){if(1==e.get(n).occupied&&0==e.get(n).attacked){e.get(n).attacked=!0;let o=e.get(n).name;t.get(o).hit(),t.get(o).isSunk()&&t.delete(o)}else 0==e.get(n).occupied&&0==e.get(n).attacked&&(e.get(n).attacked=!0)}}}(),attack:function(e,t){null!=e.coordinates.get(t)&&e.receiveAttack(t)},computerAI:function(){let e=[],t=Math.floor(10*Math.random()),n=Math.floor(10*Math.random());return e.push(t,n),JSON.stringify(e)}}},t=function(e,t){const o=document.getElementById(e);n(o,t)},n=function(e,t){for(let n=9;n>-1;n--){let o=document.createElement("div");o.setAttribute("class",`row-${n}`),o.style.height="10%",o.style.display="flex",0!==n&&(o.style.borderBottom="1px solid black"),e.append(o);for(let e=0;e<10;e++){let i=document.createElement("div");i.setAttribute("class",`x${e}-${n}`),i.classList.add(t),i.style.flexGrow="1",9!==e&&(i.style.borderRight="1px solid black"),o.append(i)}}},o=function(e,t){let n=e.target.className,o=n.split(" ");o=o.join("."),console.log(o);let i=`[${n.slice(1,2)},${n.slice(3,4)}]`;t.receiveAttack(i),console.log(t.coordinates.get(i).occupied),console.log(t),1==t.coordinates.get(i).occupied?(document.querySelector(`.${o}`).classList.add("hit"),document.getElementById("message").innerText="Message: HIT"):(document.querySelector(`.${o}`).classList.add("miss"),document.getElementById("message").innerText="Message: MISS")},i=e(),s=e();t("map-enemy","enemy"),t("map-user","player"),s.board.placeShip(5,"[0,5]",!0,"destoyer"),s.board.placeShip(5,"[1,5]",!0,"destoyer"),s.board.placeShip(5,"[2,5]",!0,"destoyer"),s.board.placeShip(5,"[3,5]",!0,"destoyer"),i.board.placeShip(5,"[0,5]",!0,"steve"),i.board.placeShip(5,"[1,5]",!0,"joe"),i.board.placeShip(5,"[2,5]",!0,"naur"),i.board.placeShip(5,"[3,5]",!0,"hmm"),i.board.placeShip(5,"[4,5]",!0,"destoyer"),function(e,t){for(let t=9;t>-1;t--)for(let n=0;n<10;n++)document.querySelector(`.x${t}-${n}.enemy`).addEventListener("click",(function t(n){o(n,e),this.removeEventListener("click",t)}))}(i.board),console.log(s.board);const c=new MutationObserver((()=>{let e=i.computerAI();i.attack(s.board,e),async function(e,t){function n(e){return new Promise((t=>setTimeout(t,e)))}await n(1500);let o=e.split(""),i=o[1];console.log(i);let s=o[3];const c=document.querySelector(`.x${i}-${s}.player`);document.getElementById("message").innerText="Message: Computer thinking...",await n(1500),1==t.coordinates.get(e).occupied?(c.classList.add("hit"),document.getElementById("message").innerText="Message: Computer HIT"):(c.classList.add("miss"),document.getElementById("message").innerText="Message: Computer MISS")}(e,s.board)}));for(let e=0;e<10;e++)c.observe(document.querySelector(`#map-enemy > .row-${e}`),{subtree:!0,attributes:!0})})();